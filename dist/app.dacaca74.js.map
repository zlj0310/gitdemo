{"version":3,"sources":["webpack:///app.dacaca74.js","webpack:///./src/components/About.tsx","webpack:///./src/components/App.tsx","webpack:///./src/components/Index.tsx","webpack:///external \"React\"","webpack:///external \"ReactRouterDOM\"","webpack:///./src/index.js","webpack:///./src/store.ts","webpack:///external \"ReactDOM\""],"names":["webpackJsonp","0","module","exports","__webpack_require__","CJFh","EsDq","__importStar","this","mod","__esModule","result","k","Object","hasOwnProperty","call","defineProperty","value","react_1","store_1","About","_a","useState","broadcastTxt","setBroadcastTxt","_b","localStorageTxt","setLocalStorageTxt","_c","indexDBTxt","setIndexDBTxt","_d","serviceWorkerTxt","setServiceWorkerTxt","_e","sharedWorkerTxt","setSharedWorkerTxt","TABS_LIST","key","id","name","data","useEffect","BroadcastChannel","onmessage","e","window","addEventListener","JSON","parse","newValue","navigator","serviceWorker","sharedWorker","SharedWorker","document","hidden","console","log","port","postMessage","get","start","publicStore","openStore","then","db","saveData","setInterval","query","res","default","createElement","className","map","item","FOiH","__importDefault","react_router_dom_1","Index_1","About_1","App","HashRouter","Route","exact","path","component","Index","GxRd","__assign","assign","t","s","i","n","arguments","length","p","prototype","txt","setTxt","getUrlParams","handleClick","localStorage","setItem","stringify","timeStamp","Date","controller","filter","placeholder","onChange","target","onClick","Jmof","React","KC3J","ReactRouterDOM","czis","lVK7","__webpack_exports__","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","__WEBPACK_IMPORTED_MODULE_1_react_dom__","__WEBPACK_IMPORTED_MODULE_2__styles_index_less__","__WEBPACK_IMPORTED_MODULE_3__components_App_tsx__","render","a","querySelector","s0Ck","query_string_1","Store","_this","dbInfo","storeName","version","tagName","searchParam","location","search","split","index","hash","indexOf","hashParam","substr","Promise","resolve","reject","request","indexedDB","open","onerror","onsuccess","onupgradeneeded","srcElement","oldVersion","objectStoreNames","contains","createObjectStore","keyPath","createIndex","unique","tx","transaction","store","objectStore","put","tag","dbRequest","err","wLXD","ReactDOM"],"mappings":"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","file":"app.dacaca74.js","sourcesContent":["webpackJsonp([0],{\n\n/***/ 0:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(\"+prg\");\nmodule.exports = __webpack_require__(\"lVK7\");\n\n\n/***/ }),\n\n/***/ \"CJFh\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"EsDq\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importStar(__webpack_require__(\"Jmof\"));\n__webpack_require__(\"czis\");\nvar store_1 = __webpack_require__(\"s0Ck\");\nexports.About = function () {\n    var _a = react_1.useState(''), broadcastTxt = _a[0], setBroadcastTxt = _a[1];\n    var _b = react_1.useState(''), localStorageTxt = _b[0], setLocalStorageTxt = _b[1];\n    var _c = react_1.useState(''), indexDBTxt = _c[0], setIndexDBTxt = _c[1];\n    var _d = react_1.useState(''), serviceWorkerTxt = _d[0], setServiceWorkerTxt = _d[1];\n    var _e = react_1.useState(''), sharedWorkerTxt = _e[0], setSharedWorkerTxt = _e[1];\n    var TABS_LIST = [\n        {\n            key: 0,\n            id: 'broadcastChannel',\n            name: 'Broadcast Channel',\n            data: broadcastTxt\n        },\n        {\n            key: 1,\n            id: 'localStorage',\n            name: 'Local Storage',\n            data: localStorageTxt\n        },\n        {\n            key: 2,\n            id: 'serviceWorker',\n            name: 'Service Worker',\n            data: serviceWorkerTxt\n        },\n        {\n            key: 3,\n            id: 'sharedWorker',\n            name: 'Shared Worker',\n            data: sharedWorkerTxt\n        },\n        {\n            key: 4,\n            id: 'indexDB',\n            name: 'IndexDB',\n            data: indexDBTxt\n        },\n    ];\n    react_1.useEffect(function () {\n        // === BroadCast Channel start ===\n        var bc = new BroadcastChannel('broadCast');\n        // 监听被广播的消息\n        bc.onmessage = function (e) {\n            setBroadcastTxt(e.data);\n        };\n        // or 使用 addEventListener 来添加 message 监听\n        // bc.addEventListener('message', (e)=> {\n        //   setBroadcastTxt(e.data)\n        // })\n        // === BroadCast Channel end ===\n        // === Local Storage start ===\n        window.addEventListener('storage', function (e) {\n            if (e.key === 'localStorageData') {\n                var value = JSON.parse(e.newValue);\n                setLocalStorageTxt(value.data);\n            }\n        });\n        // === Local Storage end ===\n        // === serviceWorker start ===\n        if (navigator.serviceWorker) {\n            navigator.serviceWorker.addEventListener('message', function (e) {\n                setServiceWorkerTxt(e.data);\n            });\n        }\n        // === serviceWorker end ===\n        // === sharedWorker start ===\n        var sharedWorker = new SharedWorker('https://webtest.huijieapp.com/xindaijia-web/entries/boilerplate/util.shared.js', 'ctc');\n        // 定时轮询，发送 get 指令的消息\n        // setInterval( () => {\n        //   sharedWorker.port.postMessage({get: true})\n        // }, 1000)\n        document.addEventListener('visibilitychange', function () {\n            if (!document.hidden) {\n                console.log('--visibilitychange--');\n                sharedWorker.port.postMessage({ get: true });\n            }\n        });\n        // 监听 get 消息的返回数据\n        sharedWorker.port.addEventListener('message', function (e) {\n            setSharedWorkerTxt(e.data);\n        }, false);\n        sharedWorker.port.start();\n        // or 使用 onmessage 来添加监听，则不需要显示调用 MessagePort.start 方法\n        // sharedWorker.onmessage = (e:any) => {\n        //   setSharedWorkerTxt(e.data)\n        // }\n        //  === sharedWorker end ===\n        // === indexDB start ===\n        store_1.publicStore.openStore().then(function (db) { return store_1.publicStore.saveData(db, null); }).then(function (db) {\n            setInterval(function () {\n                store_1.publicStore.query(db).then(function (res) {\n                    if (res && res.data) {\n                        setIndexDBTxt(res.data);\n                    }\n                });\n            }, 1000);\n        });\n        // === indexDB end ===\n    }, []);\n    return (react_1.default.createElement(\"div\", { className: \"home--wrapper\" }, TABS_LIST.map(function (item) { return (react_1.default.createElement(\"div\", { className: \"item\", key: item.id },\n        react_1.default.createElement(\"h2\", null, item.name),\n        react_1.default.createElement(\"p\", null,\n            react_1.default.createElement(\"em\", null, \"\\u63A5\\u6536\\u5230\\u7684\\u6D88\\u606F\\uFF1A\"),\n            item.data))); })));\n};\n\n\n/***/ }),\n\n/***/ \"FOiH\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importDefault(__webpack_require__(\"Jmof\"));\nvar react_router_dom_1 = __webpack_require__(\"KC3J\");\nvar Index_1 = __webpack_require__(\"GxRd\");\nvar About_1 = __webpack_require__(\"EsDq\");\nexports.App = function () {\n    return (react_1.default.createElement(react_router_dom_1.HashRouter, null,\n        react_1.default.createElement(\"section\", { className: \"App\" },\n            react_1.default.createElement(react_router_dom_1.Route, { exact: true, path: \"/\", component: Index_1.Index }),\n            react_1.default.createElement(react_router_dom_1.Route, { exact: true, path: \"/about\", component: About_1.About }))));\n};\n\n\n/***/ }),\n\n/***/ \"GxRd\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importStar(__webpack_require__(\"Jmof\"));\n__webpack_require__(\"czis\");\nvar store_1 = __webpack_require__(\"s0Ck\");\nexports.Index = function () {\n    var _a = react_1.useState({}), txt = _a[0], setTxt = _a[1];\n    var key = store_1.publicStore.getUrlParams().key;\n    var sharedWorker = new SharedWorker('https://webtest.huijieapp.com/xindaijia-web/entries/boilerplate/util.shared.js', 'ctc');\n    var TABS_LIST = [\n        {\n            key: 0,\n            id: 'broadcastChannel',\n            name: 'Broadcast Channel',\n            handleClick: function (id) {\n                // 创建一个用于广播的通信频道\n                var bc = new BroadcastChannel('broadCast');\n                // 发送广播消息\n                bc.postMessage(txt[id]);\n            }\n        },\n        {\n            key: 1,\n            id: 'localStorage',\n            name: 'Local Storage',\n            handleClick: function (id) {\n                window.localStorage.setItem('localStorageData', JSON.stringify({ data: txt[id], timeStamp: +(new Date) }));\n            }\n        },\n        {\n            key: 2,\n            id: 'serviceWorker',\n            name: 'Service Worker',\n            handleClick: function (id) {\n                if (navigator.serviceWorker && navigator.serviceWorker.controller) {\n                    navigator.serviceWorker.controller.postMessage(txt[id]);\n                }\n            }\n        },\n        {\n            key: 3,\n            id: 'sharedWorker',\n            name: 'Shared Worker',\n            handleClick: function (id) {\n                sharedWorker.port.postMessage(txt[id]);\n            }\n        },\n        {\n            key: 4,\n            id: 'indexDB',\n            name: 'IndexDB',\n            handleClick: function (id) {\n                store_1.publicStore.openStore().then(function (db) { return store_1.publicStore.saveData(db, null); }).then(function (db) { return store_1.publicStore.saveData(db, txt[id]); });\n            }\n        },\n    ];\n    return (react_1.default.createElement(\"div\", { className: \"home--wrapper\" }, key ?\n        TABS_LIST.filter(function (i) { return (i.key === key); }).map(function (item) { return (react_1.default.createElement(\"div\", { className: \"item\", key: item.id },\n            react_1.default.createElement(\"h2\", null, item.name),\n            react_1.default.createElement(\"input\", { placeholder: \"input message\", onChange: function (e) {\n                    var _a;\n                    return setTxt(__assign({}, txt, (_a = {}, _a[item.id] = e.target.value, _a)));\n                } }),\n            react_1.default.createElement(\"button\", { onClick: function () { return item.handleClick(item.id); } }, \"\\u53D1\\u9001\\u6D88\\u606F\"))); })\n        : TABS_LIST.map(function (item) { return (react_1.default.createElement(\"div\", { className: \"item\", key: item.id },\n            react_1.default.createElement(\"h2\", null, item.name),\n            react_1.default.createElement(\"input\", { placeholder: \"input message\", onChange: function (e) {\n                    var _a;\n                    return setTxt(__assign({}, txt, (_a = {}, _a[item.id] = e.target.value, _a)));\n                } }),\n            react_1.default.createElement(\"button\", { onClick: function () { return item.handleClick(item.id); } }, \"\\u53D1\\u9001\\u6D88\\u606F\"))); })));\n};\n\n\n/***/ }),\n\n/***/ \"Jmof\":\n/***/ (function(module, exports) {\n\nmodule.exports = React;\n\n/***/ }),\n\n/***/ \"KC3J\":\n/***/ (function(module, exports) {\n\nmodule.exports = ReactRouterDOM;\n\n/***/ }),\n\n/***/ \"czis\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"lVK7\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(\"Jmof\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react_dom__ = __webpack_require__(\"wLXD\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_react_dom___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_react_dom__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__styles_index_less__ = __webpack_require__(\"CJFh\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__styles_index_less___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__styles_index_less__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_App_tsx__ = __webpack_require__(\"FOiH\");\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_App_tsx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__components_App_tsx__);\n\n\n\n\n\nObject(__WEBPACK_IMPORTED_MODULE_1_react_dom__[\"render\"])(__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_3__components_App_tsx__[\"App\"], null), document.querySelector('#app'));\n\n/***/ }),\n\n/***/ \"s0Ck\":\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar query_string_1 = __importDefault(__webpack_require__(\"OAwv\"));\nvar Store = /** @class */ (function () {\n    function Store() {\n        var _this = this;\n        this.dbInfo = {\n            storeName: 'testDB1',\n            version: 2,\n            tagName: 'ctc_data1'\n        };\n        // 获取URL参数\n        this.getUrlParams = function () {\n            var searchParam = query_string_1.default.parse(window.location.search.split('?')[1]);\n            var index = window.location.hash.indexOf('?');\n            var hashParam = query_string_1.default.parse(window.location.hash.substr(index).split('?')[1]);\n            return __assign({}, searchParam, hashParam);\n        };\n        // 打开数据库\n        this.openStore = function () {\n            return new Promise(function (resolve, reject) {\n                if (!('indexedDB' in window)) {\n                    return reject('don\\'t support indexedDB');\n                }\n                var request = indexedDB.open(_this.dbInfo.storeName, _this.dbInfo.version || 1);\n                request.onerror = reject; // 请求失败的回调函数句柄\n                request.onsuccess = function (e) {\n                    resolve(e.target.result); // 请求成功的回调函数句柄\n                };\n                request.onupgradeneeded = function (e) {\n                    var db = e.srcElement.result;\n                    if (e.oldVersion === 0 && !db.objectStoreNames.contains(_this.dbInfo.storeName)) {\n                        var store = db.createObjectStore(_this.dbInfo.storeName, { keyPath: 'tag' });\n                        store.createIndex(_this.dbInfo.storeName + 'Index', 'tag', { unique: false });\n                    }\n                };\n            });\n        };\n        // 保存至数据库\n        this.saveData = function (db, data) {\n            return new Promise(function (resolve, reject) {\n                var tx = db.transaction(_this.dbInfo.storeName, 'readwrite');\n                var store = tx.objectStore(_this.dbInfo.storeName);\n                var request = store.put({ tag: _this.dbInfo.tagName, data: data });\n                request.onsuccess = function () { return resolve(db); };\n                request.onerror = reject;\n            });\n        };\n        // 查询数据库\n        this.query = function (db) {\n            return new Promise(function (resolve, reject) {\n                try {\n                    var tx = db.transaction(_this.dbInfo.storeName, 'readonly');\n                    var store = tx.objectStore(_this.dbInfo.storeName);\n                    var dbRequest = store.get(_this.dbInfo.tagName);\n                    dbRequest.onsuccess = function (e) { return resolve(e.target.result); };\n                    dbRequest.onerror = reject;\n                }\n                catch (err) {\n                    reject(err);\n                }\n            });\n        };\n    }\n    return Store;\n}());\nexports.publicStore = new Store();\n\n\n/***/ }),\n\n/***/ \"wLXD\":\n/***/ (function(module, exports) {\n\nmodule.exports = ReactDOM;\n\n/***/ })\n\n},[0]);\n\n\n// WEBPACK FOOTER //\n// app.dacaca74.js","import React, {useEffect, useState} from 'react'\nimport '../styles/home.less'\nimport {publicStore} from '../store'\n\nexport const About = () => {\n  const [broadcastTxt, setBroadcastTxt] = useState('')\n  const [localStorageTxt, setLocalStorageTxt] = useState('')\n  const [indexDBTxt, setIndexDBTxt] = useState('')\n  const [serviceWorkerTxt, setServiceWorkerTxt] = useState('')\n  const [sharedWorkerTxt, setSharedWorkerTxt] = useState('')\n  const TABS_LIST = [\n    {\n      key: 0,\n      id: 'broadcastChannel',\n      name: 'Broadcast Channel',\n      data: broadcastTxt\n    },\n    {\n      key: 1,\n      id: 'localStorage',\n      name: 'Local Storage',\n      data: localStorageTxt\n    },\n    {\n      key: 2,\n      id: 'serviceWorker',\n      name: 'Service Worker',\n      data: serviceWorkerTxt\n    },\n    {\n      key: 3,\n      id: 'sharedWorker',\n      name: 'Shared Worker',\n      data: sharedWorkerTxt\n    },\n    {\n      key: 4,\n      id: 'indexDB',\n      name: 'IndexDB',\n      data: indexDBTxt\n    },\n  ]\n  useEffect(()=> {\n    // === BroadCast Channel start ===\n    const bc = new BroadcastChannel('broadCast')\n    // 监听被广播的消息\n    bc.onmessage = (e) => {\n      setBroadcastTxt(e.data)\n    }\n    // or 使用 addEventListener 来添加 message 监听\n    // bc.addEventListener('message', (e)=> {\n    //   setBroadcastTxt(e.data)\n    // })\n    // === BroadCast Channel end ===\n\n    // === Local Storage start ===\n    window.addEventListener('storage', (e) => {\n      if (e.key === 'localStorageData') {\n        const value = JSON.parse(e.newValue)\n        setLocalStorageTxt(value.data)\n      }\n    })\n    // === Local Storage end ===\n\n    // === serviceWorker start ===\n    if(navigator.serviceWorker) {\n      navigator.serviceWorker.addEventListener('message', (e) => {\n        setServiceWorkerTxt( e.data)\n      })\n    }\n    // === serviceWorker end ===\n\n    // === sharedWorker start ===\n    const sharedWorker = new SharedWorker('https://webtest.huijieapp.com/xindaijia-web/entries/boilerplate/util.shared.js', 'ctc')\n    // 定时轮询，发送 get 指令的消息\n    // setInterval( () => {\n    //   sharedWorker.port.postMessage({get: true})\n    // }, 1000)\n    document.addEventListener('visibilitychange', () => {\n      if (!document.hidden) {\n        console.log('--visibilitychange--')\n        sharedWorker.port.postMessage({get: true})\n      }\n    })\n\n    // 监听 get 消息的返回数据\n    sharedWorker.port.addEventListener('message', (e:any) => {\n        setSharedWorkerTxt(e.data)\n    }, false)\n    sharedWorker.port.start()\n\n    // or 使用 onmessage 来添加监听，则不需要显示调用 MessagePort.start 方法\n    // sharedWorker.onmessage = (e:any) => {\n    //   setSharedWorkerTxt(e.data)\n    // }\n    //  === sharedWorker end ===\n\n    // === indexDB start ===\n    publicStore.openStore().then(db => publicStore.saveData(db, null)).then((db:any) => {\n      setInterval(() => {\n        publicStore.query(db).then( (res:any) => {\n          if (res && res.data) {\n            setIndexDBTxt(res.data)\n          }\n        })\n      }, 1000)\n    })\n    // === indexDB end ===\n  },[])\n\n  return (\n    <div className=\"home--wrapper\">\n      {TABS_LIST.map((item:any) => (\n        <div className=\"item\" key={item.id}>\n          <h2>{item.name}</h2>\n          <p><em>接收到的消息：</em>{item.data}</p>\n        </div>\n      ))}\n    </div>\n  )\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/About.tsx","import React from 'react'\nimport { HashRouter as Router, Route } from 'react-router-dom'\nimport { Index } from './Index'\nimport { About } from './About'\n\nexport const App = () => {\n  return (\n    <Router>\n      <section className=\"App\">\n        <Route exact path=\"/\" component={Index} />\n        <Route exact path=\"/about\" component={About} />\n      </section>\n    </Router>\n  )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/App.tsx","import React, {useState} from 'react'\nimport '../styles/home.less'\nimport {publicStore} from '../store'\n\nexport const Index = () => {\n  const [txt, setTxt] = useState({} as any)\n  const key:any = publicStore.getUrlParams().key\n  const sharedWorker = new SharedWorker('https://webtest.huijieapp.com/xindaijia-web/entries/boilerplate/util.shared.js', 'ctc')\n\n  const TABS_LIST = [\n    {\n      key: 0,\n      id: 'broadcastChannel',\n      name: 'Broadcast Channel',\n      handleClick: (id:string) => {\n        // 创建一个用于广播的通信频道\n        const bc = new BroadcastChannel('broadCast')\n        // 发送广播消息\n        bc.postMessage(txt[id])\n      }\n    },\n    {\n      key: 1,\n      id: 'localStorage',\n      name: 'Local Storage',\n      handleClick: (id:string) => {\n        window.localStorage.setItem('localStorageData', JSON.stringify({data: txt[id], timeStamp: +(new Date)}))\n      }\n    },\n    {\n      key: 2,\n      id: 'serviceWorker',\n      name: 'Service Worker',\n      handleClick: (id:string) => {\n        if(navigator.serviceWorker && navigator.serviceWorker.controller){\n          navigator.serviceWorker.controller.postMessage(txt[id])\n        }\n      }\n    },\n    {\n      key: 3,\n      id: 'sharedWorker',\n      name: 'Shared Worker',\n      handleClick: (id:string) => {\n        sharedWorker.port.postMessage(txt[id])\n      }\n    },\n    {\n      key: 4,\n      id: 'indexDB',\n      name: 'IndexDB',\n      handleClick: (id:string) => {\n        publicStore.openStore().then(db => publicStore.saveData(db, null)).then((db:any) => publicStore.saveData(db,  txt[id]))\n      }\n    },\n  ]\n  return (\n    <div className=\"home--wrapper\">\n      {key ?\n        TABS_LIST.filter(i => (i.key === key)).map((item:any) => (\n          <div className=\"item\" key={item.id}>\n            <h2>{item.name}</h2>\n            <input placeholder=\"input message\" onChange={e => setTxt({...txt, ...{[item.id]: e.target.value}})}/>\n            <button onClick={()=>item.handleClick(item.id)}>发送消息</button>\n          </div>\n        ))\n      : TABS_LIST.map((item:any) => (\n        <div className=\"item\" key={item.id}>\n          <h2>{item.name}</h2>\n          <input placeholder=\"input message\" onChange={e => setTxt({...txt, ...{[item.id]: e.target.value}})}/>\n          <button onClick={()=>item.handleClick(item.id)}>发送消息</button>\n        </div>\n      ))}\n    </div>\n  )\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/Index.tsx","module.exports = React;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"React\"\n// module id = Jmof\n// module chunks = 0","module.exports = ReactRouterDOM;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactRouterDOM\"\n// module id = KC3J\n// module chunks = 0","import React from 'react'\nimport {render} from 'react-dom'\nimport './styles/index.less'\nimport {App} from './components/App.tsx'\n\nrender(<App />, document.querySelector('#app'))\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import querystring from 'query-string'\nclass Store {\n  public dbInfo = {\n    storeName: 'testDB1',\n    version: 2,\n    tagName: 'ctc_data1'\n  }\n  // 获取URL参数\n  public getUrlParams = () => {\n    const searchParam = querystring.parse(window.location.search.split('?')[1])\n    const index = window.location.hash.indexOf('?')\n    const hashParam = querystring.parse(window.location.hash.substr(index).split('?')[1])\n    return { ...searchParam, ...hashParam }\n  }\n\n  // 打开数据库\n  public openStore = () => {\n    return new Promise( (resolve, reject) =>{\n        if (!('indexedDB' in window)) {\n            return reject('don\\'t support indexedDB')\n        }\n        const request = indexedDB.open(this.dbInfo.storeName, this.dbInfo.version || 1)\n        request.onerror = reject  // 请求失败的回调函数句柄\n        request.onsuccess = (e:any) => {\n          resolve(e.target.result)  // 请求成功的回调函数句柄\n        }\n        request.onupgradeneeded = (e:any) => {  // 请求数据库版本变化句柄\n            const db = e.srcElement.result\n            if (e.oldVersion === 0 && !db.objectStoreNames.contains(this.dbInfo.storeName)) {\n                const store = db.createObjectStore(this.dbInfo.storeName, {keyPath: 'tag'})\n                store.createIndex(this.dbInfo.storeName + 'Index', 'tag', {unique: false})\n            }\n        }\n    })\n  }\n\n  // 保存至数据库\n  public saveData = (db:any, data:any) =>{\n    return new Promise( (resolve, reject) => {\n        const tx = db.transaction(this.dbInfo.storeName, 'readwrite')\n        const store = tx.objectStore(this.dbInfo.storeName)\n        const request = store.put({tag: this.dbInfo.tagName, data})\n        request.onsuccess = () => resolve(db)\n        request.onerror = reject\n    })\n  }\n\n  // 查询数据库\n  public query = (db:any) => {\n    return new Promise((resolve, reject) => {\n      try {\n          const tx = db.transaction(this.dbInfo.storeName, 'readonly')\n          const store = tx.objectStore(this.dbInfo.storeName)\n          const dbRequest = store.get(this.dbInfo.tagName)\n          dbRequest.onsuccess = (e:any) => resolve(e.target.result)\n          dbRequest.onerror = reject\n      }\n      catch (err) {\n          reject(err)\n      }\n    })\n  }\n}\n\nexport const publicStore = new Store()\n\n\n\n// WEBPACK FOOTER //\n// ./src/store.ts","module.exports = ReactDOM;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ReactDOM\"\n// module id = wLXD\n// module chunks = 0"],"sourceRoot":""}